CNN应用案例：图像分类、目标检测、语义分割、场景理解、图像生成



无监督学习方法：层次聚类、k均值聚类、高斯混合模型（GMM）、自组织映射（SOM）、隐马尔可夫模型（HMM）。

____

## 传统特征描述符

### HOG

> Histogram of Oriented Gradient，方向梯度直方图

用于自动检测图像中的对象，HOG描述符对图像中局部部分的梯度方向的分布进行编码。

背后的想法：通过边缘方向的直方图来描述图像内的对象外观和形状。



实现步骤：

1、图像预处理：伽马校正和灰度化。

2、计算图像在水平和垂直方向上的梯度值；

![img](https://pic1.zhimg.com/80/v2-1d866ca3e02c8288b17c9b714f71f5f0_hd.jpg)

对于像素点A，水平梯度$g_x=30-20=10$，垂直梯度$g_y=64-32=32$。

计算梯度强度值$g$和梯度方向$\theta$：
$$
g=\sqrt{g_x^2+g_y^2} \\
\theta=arctan\frac{g_y}{g_x}
$$

由于梯度方向将会取绝对值，因此梯度方向的范围是0~180度。

3、按non-overlap取一个$8\times 8$的cell计算梯度直方图，则就会有$8*\times 8\times 2=128$个值。若将0~180度分成9个bins，分别是$0,20,\cdots,160$，然后统计每个像素点的梯度方向所在的bin，对该bin的投票值由梯度强制决定。统计完64个点的值，可得到一个直方图，即为大小为9的vector。

4、由4个cell组成$16\times 16$的block，block由cell按步长1迭代截取。此时，4个cell组成大小为36的vector，再进行归一化，以降低光照的影响。

5、对于$64\times 128$大小的图像而言，将会有7个水平位置和15个竖直位置的block，共有$7\times 15=105$个block。整合所有block的vector，形成大小为$36\times 105=3780$的vector，即为HOG特征向量。



一般来说，只有图像区域比较小的情况，基于统计原理的直方图对于该区域才有表达能力；如果图像区域比较大，那么两个完全不同的图像的HOG特征可能很相似；但如果区域较小，这种可能性就很小。因此，需要把图像分割成很多区块，然后对每个区块计算HOG特征。

a. 图像分割策略：overlap、non-overlap。

​		overlap：可防止对一些物体的切割，如分割的时候正好把眼睛切割并且分到了两个区块中，提取完HOG特征之后，会影响接下来的分类效果，但如果使用overlap，那么至少在一个区块里会有完整的眼睛。	缺点：计算量大，重叠区域的像素需要重复计算。





HOG特征：https://zhuanlan.zhihu.com/p/40960756

https://blog.csdn.net/zhanghenan123/article/details/80853523

______

### SIFT

> 尺度不变特征变换（Scale-invariant Feature Transform）

局部不变性包括：尺度不变性、旋转不变性。

1. 尺度不变性：在识别物体时，不管这个物体或远或近，都能对它进行正确的辨认。
2. 旋转不变性：在物体发生旋转时，照样可以正确地辨认它。



​	对旋转、尺度缩放、亮度变化保持保持不变，对视觉变化、仿射变换、噪声也保持一定程度的稳定性。



#### 尺度空间

​	在未知的场景中，计算机视觉并不能提供物体的尺度大小，其中的一种方法是把物体不同尺度下的图像都提供给机器，让机器能够对物体在不同的尺度下有一个统一的认知。

​	**高斯尺度空间**：对图像金字塔的每层图像使用不同的参数$\sigma$进行高斯模糊，使每层金字塔有多张高斯模糊过的图像。降采样时，金字塔上边一组图像的第一张由其下面一组图像倒数第三张降采样得到。

​	高斯模糊：
$$
L(x,y,\sigma)=G(x, y,\sigma)*I(x,y)
$$
其中，$G(x,y,\sigma)$为高斯核函数：
$$
G(x,y,\sigma)=\frac{1}{2\pi \sigma^2}e^{\frac{x^2+y^2}{2\sigma^2}}
$$
$\sigma$为尺度空间因子，是高斯正态分布的标准差，反映了图像被模糊的程度，其值越大图像越模糊。

​	将相邻的两个高斯空间的图像相减就得到了DoG（高斯差分，Difference of Gaussian）图像。定义为：
$$
D(x,y,\sigma)=|G(x,y,k\sigma)-G(x,y,\sigma)|*I(x,y) \\
=L(x,y,k\sigma)-L(x,y,\sigma)
$$
高斯金字塔的组数一般为：$o=[log_2min(m,n)] -a$。$m, n$分别为图像的行和列。



​	为了寻找空间的极值点，每个像素点要和同一尺度空间（图像域）和相邻尺度空间（尺度域）的所有相邻点进行比较，当其大于（或小于）所有相邻的点时，该点就是极值点。即要和邻近的26个像素点进行比较。

​	由于每组图像的第一层和最后一层是无法进行比较取得极值的。为了满足尺度变换的连续性，在每一组图像的顶层继续使用高斯模糊生成3幅图像，则高斯金字塔每组有$S+3$层图像，DoG金字塔每组有$S+2$图像。 ？？



​	剔除不好的极值点：1）低对比度的特征点；2）不稳定的边缘响应点。 ？？



​	求取特征点的主方向

​	为了实现图像旋转不变性，需要给特征点的方向进行赋值。其求取过程类似HOG计算梯度强度值$g$和梯度方向$\theta$。然后使用直方图来统计特征点领域内像素对应的梯度强度和梯度方向，在直方图中的峰值就是该特征点的主方向。计算以特征点位中心、以$3\times 1.5\sigma$为半径的区域内各个像素点的梯度强制和梯度方向。在梯度直方图中，当存在一个相当于主峰值80%能量的柱值时，则可将这个方向认为是该特征点的辅助方向。所以，一个特征点可能检测到多个方向。

​	

​	生成特征描述子

​	为了保证特征矢量的旋转不变性，需以特征点为中心，在附近领域内将坐标轴旋转$\theta$（特征点的主方向）度，即将坐标轴旋转为特征点的方向，旋转后领域内的像素坐标为：
$$
\begin{bmatrix}
x'\\ 
y'
\end{bmatrix}=\begin{bmatrix}
cos\theta & -sin\theta \\ 
sin\theta & cos\theta
\end{bmatrix}\begin{bmatrix}
x\\ 
y
\end{bmatrix}
$$
​	旋转后，以特征点位中心取$16\times 16$的窗口，求取每个像素的梯度值和梯度方向，之后在每个$4\times 4$的小块上绘制8个方向的梯度直方图，即可形成一个种子点。此时，每个特征点有16个种子点组成，每个种子点有8个方向的向量信息，即可产生$4\times 4\times 8=128$维的SIFT特征向量。最后，做归一化处理，去除光照的影响。

![这里写图片描述](https://img-blog.csdn.net/20180808163031626?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1Nha3VyYTU1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)





SIFT算法原理解析：https://blog.csdn.net/hit2015spring/article/details/52895367

SIFT四部曲——极值检测和定位：https://blog.csdn.net/hit2015spring/article/details/52972890

SIFT四部曲——方向角度确定：https://blog.csdn.net/hit2015spring/article/details/56673955

SIFT算法总结：https://blog.csdn.net/jancis/article/details/80824793



### SURF





### Harris





### Fast算子

